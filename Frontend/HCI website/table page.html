<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>نظام الاعتماد الأكاديمي</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #F4F6F8;
      margin: 0;
      padding: 0;
      display: flex;
      direction: rtl; 
    }

    .sidebar {
      width: 250px;
      background-color: #00A650;
      color: white;
      height: 100vh;
      padding: 20px;
      box-sizing: border-box;
      position: fixed;
      right: 0;
      top: 0;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .sidebar img {
      display: block;
      margin: 0 auto 20px;
      width: 80%;
    }

    .sidebar .profile {
      text-align: center;
      margin-top: 20px;
    }

    .sidebar .profile img {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      border: 2px solid white;
    }

    .sidebar .profile h3 {
      margin: 10px 0 5px;
    }

    .sidebar .profile p {
      margin: 0;
      font-size: 14px;
    }

    .sidebar .menu {
      margin-top: 30px;
    }

    .sidebar .menu a {
      display: flex;
      align-items: center;
      gap: 10px;
      color: white;
      text-decoration: none;
      padding: 10px;
      margin: 10px 0;
      background-color: #00A650;
      border-radius: 5px;
      text-align: right;
      cursor: pointer;
    }

    .sidebar .menu a img {
      width: 20px;
      height: 20px;
    }

    .sidebar .menu a:hover {
      background-color: #008C3E;
    }

    .sidebar .logout {
      background-color: #000000;
      text-align: center;
      justify-content: center;
      padding: 10px;
      border-radius: 5px;
      color: white;
      text-decoration: none;
      margin-top: auto;
    }

    .container {
      flex: 1;
      padding: 20px;
      box-sizing: border-box;
      margin-right: 270px;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .header h1 {
      margin: 0;
      color: #00A650;
    }

    .dropdown-container {
      background-color: #D8E6E1;
      padding: 20px;
      border-radius: 8px;
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 5px;
      align-items: center;
      text-align: right;
    }

    .dropdown-container label {
      font-weight: bold;
      color: #000000;
      white-space: nowrap; 
     margin-left: 10px; 
    }

    .dropdown-container select {
      padding: 10px;
      border: 1px solid #00A650;
      border-radius: 4px;
      direction: rtl;
      width: 300px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }

    table, th, td {
      border: 1px solid #00A650;
    }

    th, td {
      padding: 10px;
      text-align: center;
    }

    th {
      background-color: #00A650;
      color: white;
    }

    .progress-bar {
      display: flex;
      justify-content: center;
      margin: 20px 0;
    }

    .progress-circle {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: #ddd;
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 0 10px;
    }

    .progress-circle.active {
      background: #00A650;
      color: white;
    }

    .popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 20px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
      z-index: 1000;
      display: none;
    }

    .popup textarea {
      width: 100%;
      height: 100px;
      margin-bottom: 10px;
      border: 1px solid #00A650;
    }

    .popup .close-btn {
      background: #000000;
      color: white;
      border: none;
      padding: 5px 10px;
      cursor: pointer;
    }

    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 999;
      display: none;
    }

    .editable {
      cursor: pointer;
      background-color: #f9f9f9;
    }

    .editable:focus {
      background-color: #fff;
      border: 1px solid #00A650;
    }

    .negative {
      color: red;
    }

    .positive {
      color: green;
    }

    .buttons {
      display: flex;
      gap: 5px;
      justify-content: center;
    }

    .buttons button {
      padding: 5px 10px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    

    
  </style>
</head>
<body>
  <div class="sidebar">
    <img src="logo new.png" alt="شعار الجامعة">
    <div class="profile">
      <img src="placeholder.jpeg" alt="صورة الملف الشخصي">
      <h3>مرحباً</h3> 
      <p id="userRole">مدير دائرة الاعتماد</p> 
    </div>
    <div class="menu">
      <a href="report.html" id="printReport">
        <img src="printer_6108458.png" alt="أيقونة الطباعة"> طباعة التقرير
      </a>
      <a href="report2.html" id="displayReport">
        <img src="view-files_72647.png" alt="أيقونة العرض"> عرض التقرير
      </a>
      <a href="#" id="downloadReport">
        <img src="download.png" alt="أيقونة التنزيل"> تنزيل التقرير
      </a>
      <a href="ادخال البيانات.html" id="addData">
        <img src="add.png" alt="أيقونة إضافة البيانات"> إضافة البيانات
    </a>
    
    </div>
    <a href="log in page.html" class="logout">تسجيل الخروج</a>
  </div>

  <div class="container">
    <div class="header">
      <h1></h1>
    </div>

    <div class="dropdown-container">
      <label for="schoolDropdown">الكلية:</label>
      <select id="schoolDropdown">
        <option value="">اختر الكلية</option>
      </select>

      <label for="departmentDropdown">القسم الأكاديمي:</label>
      <select id="departmentDropdown">
        <option value="">اختر القسم</option>
      </select>

      <label for="degreeDropdown">الدرجة العلمية:</label>
      <select id="degreeDropdown">
        <option value="">اختر الدرجة العلمية</option>
      </select>

      <label for="programDropdown">البرنامج:</label>
      <select id="programDropdown">
        <option value="">اختر البرنامج</option>
      </select>
    </div>

    <table>
      <thead>
        <tr>
          <th>الكلية</th>
          <th>القسم</th>
          <th>الدرجة العلمية</th>
          <th>البرنامج</th>
          <th>الطاقة الاستيعابية</th>
          <th>عدد الطلبة على مقاعد الدراسة</th>
          <th>عدد الطلبة المسموح بقبولهم</th>
          <th>الاقتراح</th>
          <th>القرار النهائي</th>
          <th>التعليقات </th>
        </tr>
      </thead>
      <tbody id="dataTable">
        
      </tbody>
    </table>

    <div class="progress-bar">
      <div class="progress-circle">1</div>
      <div class="progress-circle">2</div>
      <div class="progress-circle">3</div>
      <div class="progress-circle">4</div>
      <div class="progress-circle">5</div>
      <div class="progress-circle">6</div>
      <div class="progress-circle active">7</div> 
    </div>

    <div class="popup" id="addCommentPopup">
      <textarea id="commentInput" placeholder="أدخل تعليقك"></textarea>
      <button id="saveComment">حفظ</button>
      <button class="close-btn">إغلاق</button>
    </div>

    <div class="popup" id="viewCommentPopup">
      <div id="commentDisplay"></div>
      <button class="close-btn">إغلاق</button>
    </div>

    <div class="overlay"></div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      
    const urlParams = new URLSearchParams(window.location.search);
    const username = urlParams.get('username');

    console.log("Username from URL:", username); 

    // Map usernames to profile pictures and roles
    const userProfiles = {
        DeptHead: { image: "DeptHead.png", role: "رئيس القسم" },
        Dean: { image: "Dean.png", role: "عميد الكلية" },
        VicePresident: { image: "VicePresident.png", role: "نائب الرئيس" },
        AQACDirector: { image: "AQACDirector.png", role: "مدير مركز الاعتماد و ضمان الجودة" },
        Registrar: { image: "Registrar.png", role: "المسجل العام" },
        DeanGraduates: { image: "DeanGraduates.png", role: "عميد كلية الدراسات العليا" },
        AccreditationDirector: { image: "AccreditationDirector.png", role: "مدير دائرة الاعتماد" }
    };

    console.log("User Profile for", username, ":", userProfiles[username]); 

    
    if (username && userProfiles[username]) {
        const profile = userProfiles[username];
        document.querySelector('.profile img').src = profile.image;
        document.getElementById('userRole').textContent = profile.role; 
    } else {
        console.log("Using default profile"); 
        document.querySelector('.profile img').src = "placeholder.jpeg";
        document.getElementById('userRole').textContent = "ضيف"; 
    }
    // Hide or show the "إضافة البيانات" button based on the user's role
    const addDataButton = document.getElementById('addData');
    if (username && userProfiles[username].role === "مدير دائرة الاعتماد") {
    addDataButton.style.display = 'flex'; 
    } else {
    addDataButton.style.display = 'none'; 
    }
 // Track the current step in the progress bar
 let currentStep = 1; 


function updateProgressBar() {
    const progressCircles = document.querySelectorAll('.progress-circle');
    progressCircles.forEach((circle, index) => {
        if (index + 1 === currentStep) {
            circle.classList.add('active');
        } else {
            circle.classList.remove('active');
        }
    });
}


updateProgressBar();


document.addEventListener('click', function (event) {
    if (event.target.classList.contains('accept-button') || event.target.classList.contains('reject-button')) {
        
        const userOrder = Object.keys(userProfiles);
        const currentUserIndex = userOrder.indexOf(username);

        if (currentUserIndex + 1 === currentStep) {
            currentStep++; 
            updateProgressBar(); 
        } else {
            alert('ليس دورك للتفاعل مع هذا الزر الآن.'); 
        }
    }
});

      const schoolDropdown = document.getElementById('schoolDropdown');
      const departmentDropdown = document.getElementById('departmentDropdown');
      const degreeDropdown = document.getElementById('degreeDropdown');
      const programDropdown = document.getElementById('programDropdown');
      const dataTable = document.getElementById('dataTable');

      // Sample Data
      const data = {
        colleges: {
          "كلية الاداب": {
            departments: ["قسم اللغة الاتجليزية ", "قسم اللغة العربية"],
            degrees: ["الدكتوراة", "الماجستير","البكالوريوس"],
            programs: ["دكتوراة لغة عربية","ماجستير اللغة العربية ", "بكالوريوس اللغة العربي"]
          },
          "كلية الملك عبدالله الثاني لتكنولوجيا المعلومات": {
            departments: ["علم الحاسوب","علم البيانات", "الذكاء الصناعي"],
            degrees: [ "الماجستير","البكالوريوس"],
            programs: ["ماجستير علم بيانات","ماجستير ذكاء صناعي ","ماجستير علم حاسوب","بكالوريوس علم حاسوب ","بكالوريوس علم بيانات ", "بكالوريوس الذكاء الصناعي"]
          }
        }
      };

      // Populate Colleges
      Object.keys(data.colleges).forEach(college => {
        const option = document.createElement('option');
        option.value = college;
        option.textContent = college;
        schoolDropdown.appendChild(option);
      });

      
      schoolDropdown.addEventListener('change', function () {
        const selectedCollege = schoolDropdown.value;
        departmentDropdown.innerHTML = '<option value="">اختر القسم</option>';
        degreeDropdown.innerHTML = '<option value="">اختر الدرجة العلمية</option>';
        programDropdown.innerHTML = '<option value="">اختر البرنامج</option>';
        dataTable.innerHTML = '';

        if (selectedCollege) {
          data.colleges[selectedCollege].departments.forEach(dept => {
            const option = document.createElement('option');
            option.value = dept;
            option.textContent = dept;
            departmentDropdown.appendChild(option);
          });
        }
      });

      
      departmentDropdown.addEventListener('change', function () {
        const selectedCollege = schoolDropdown.value;
        const selectedDept = departmentDropdown.value;
        degreeDropdown.innerHTML = '<option value="">اختر الدرجة العلمية</option>';
        programDropdown.innerHTML = '<option value="">اختر البرنامج</option>';
        dataTable.innerHTML = '';

        if (selectedCollege && selectedDept) {
          data.colleges[selectedCollege].degrees.forEach(degree => {
            const option = document.createElement('option');
            option.value = degree;
            option.textContent = degree;
            degreeDropdown.appendChild(option);
          });
        }
      });

      
      degreeDropdown.addEventListener('change', function () {
        const selectedCollege = schoolDropdown.value;
        const selectedDegree = degreeDropdown.value;
        programDropdown.innerHTML = '<option value="">اختر البرنامج</option>';
        dataTable.innerHTML = '';

        if (selectedCollege && selectedDegree) {
          data.colleges[selectedCollege].programs.forEach(program => {
            const option = document.createElement('option');
            option.value = program;
            option.textContent = program;
            programDropdown.appendChild(option);
          });
        }
      });

      
      programDropdown.addEventListener('change', function () {
        const selectedProgram = programDropdown.value;
        dataTable.innerHTML = '';

        if (selectedProgram) {
    // Generate mock data for capacity and number of students
    const capacity = Math.floor(Math.random() * 100) + 50; // Random capacity between 50 and 150
    const students = Math.floor(Math.random() * capacity); 

    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${schoolDropdown.value}</td>
      <td>${departmentDropdown.value}</td>
      <td>${degreeDropdown.value}</td>
      <td>${selectedProgram}</td>
      <td contenteditable="true" class="editable capacity">${capacity}</td> <!-- Mock capacity -->
      <td contenteditable="true" class="editable students">${students}</td> <!-- Mock number of students -->
      <td class="difference"></td>
      <td class="buttons">
          <button class="accept-button">قبول</button>
          <button class="reject-button">رفض</button>
      </td>
      <td></td>
      <td class="buttons">
          <button class="view-comments-button">عرض</button>
          <button class="add-comments-button">اضافة</button>
      </td>
          `;
          dataTable.appendChild(row);

          
          const capacityCell = row.querySelector('.capacity');
          const studentsCell = row.querySelector('.students');
          const differenceCell = row.querySelector('.difference');

          const updateDifference = () => {
      const capacity = parseInt(capacityCell.textContent) || 0;
      const students = parseInt(studentsCell.textContent) || 0;
      const difference = capacity - students;
      differenceCell.textContent = difference;
      differenceCell.className = difference < 0 ? 'difference negative' : 'difference positive';
    };

    
    updateDifference();

    
    capacityCell.addEventListener('input', updateDifference);
    studentsCell.addEventListener('input', updateDifference);
  }
});

      
document.addEventListener('click', function (event) {
  if (event.target.classList.contains('view-comments-button')) {
    window.location.href = 'التعليقات.html'; 
  }
});


document.addEventListener('click', function (event) {
  if (event.target.classList.contains('add-comments-button')) {
    window.location.href = 'add comments.html'; 
  }
});

  
  document.getElementById('printReport').addEventListener('click', function () {
    const reportWindow = window.open('report.html', '_blank'); 
    if (reportWindow) {
        const interval = setInterval(() => {
            if (reportWindow.document.readyState === 'complete') {
                clearInterval(interval); 
                reportWindow.print();    
            }
        }, 100); 
    } else {
        alert('يرجى السماح بفتح النوافذ المنبثقة للطباعة.');
    }
});
      // Popup Management
      function showPopup(popup) {
        popup.style.display = 'block';
        overlay.style.display = 'block';
      }

      function closePopup(popup) {
        popup.style.display = 'none';
        overlay.style.display = 'none';
      }

      document.querySelectorAll('.close-btn').forEach(btn => {
        btn.addEventListener('click', function () {
          closePopup(btn.closest('.popup'));
        });
      });

      overlay.addEventListener('click', function () {
        closePopup(document.querySelector('.popup'));
      });

      
      
      document.getElementById('displayReport').addEventListener('click', function () {
        alert('تم تفعيل وظيفة عرض التقرير'); 
      });

      document.getElementById('downloadReport').addEventListener('click', function () {
        alert('تم تفعيل وظيفة تنزيل التقرير'); 
      });
    });
  
  </script>
</body>
</html>
